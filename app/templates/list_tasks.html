<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>To-Do List</title>
    <link rel="stylesheet" href="../static/styles.css" />
  </head>
  <body>
    <button class="toggle-dark">Toggle Dark Mode</button>
    <div class="container">
      <h1>To-Do List</h1>
      <a href="/add" class="button">Add Task</a>
      <table>
        <thead>
          <tr>
            <th>Title</th>
            <th>Description</th>
            <th>Due Date</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}
          <tr>
            <td>{{ task[1] }}</td>
            <td>{{ task[2] }}</td>
            <td>{{ task[3] }}</td>
            <td>{{ task[4] }}</td>
            <td>
              <!-- Update button -->
              <form
                action="/update/{{ task[0] }}"
                method="get"
                style="display: inline"
              >
                <button type="submit" class="action-btn update-btn">
                  Update
                </button>
              </form>

              <!-- Delete button -->
              <form
                action="/delete/{{ task[0] }}"
                method="post"
                style="display: inline"
              >
                <button type="submit" class="action-btn delete-btn">
                  Delete
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <script>
      const toggleBtn = document.querySelector(".toggle-dark");
      const body = document.body;

      // Load dark mode preference
      if (localStorage.getItem("darkMode") === "enabled") {
        body.classList.add("dark-mode");
      }

      toggleBtn.addEventListener("click", () => {
        body.classList.toggle("dark-mode");

        // Save preference in localStorage
        if (body.classList.contains("dark-mode")) {
          localStorage.setItem("darkMode", "enabled");
        } else {
          localStorage.setItem("darkMode", "disabled");
        }
      });
    </script>
  </body>
</html>
